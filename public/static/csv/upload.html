<div class="row-fluid">
  Test File
  <ol>
   <li>
    <a href="static/test_files/1.csv">ถ้ำลอด - ข้อมูลผู้ป่วย_รพสต.ถ้ำลอด</a>
   </li>
  </ol>
</div>

<div class="row-fluid">
  <div class="span12">    
    <!--
    <div ng-include="'static/csv/header.html'"></div>
    -->
    <div class="row-fluid well">
      <div class="span6"> 
      <div class="row-fluid">
      <form class="form-inline pull-left"  
        id="file_upload_form" 
        method="post" enctype="multipart/form-data" 
        action="csv/upload" 
        target="upload_target" class="form-horizontal">
        <div class="btn-group">
            Select File     
            <input type="file" name="file" 
              id="file" 
              onchange="angular.element(this).scope().setFile(this)"/>
          <button type="submit" 
            ng-disabled="theFile==null"
            class="btn btn-primary start">
           <i class="icon-upload icon-white"></i>Upload
          </button>                
        </div>                         
      </form>
      </div> 
      <div class="row-fluid">
        <span ng-show="theFile">
          <!-- {{theFile.name}}--> {{data.csv.length}}
        </span>
      </div>
      </div>
      <div class="span6">
        <!--List of Function-->
          <div class="row-fluid" ng-show="theFile">
            <div class="input-append">
              <select ng-model="type" class="input-medium" 
                ng-options="a.name for a in mapping_schema">
              </select>
              <button class="btn btn-success" ng-click="test()">Run</button>
            </div>
          </div>
        <!--Result-->
      </div>
    </div>
    <div class="row-fluid">
      <span ng-switch on="success">
       <span ng-switch-when="true">
        <span class="label label-success" ng-show="total_docs>0">
         {{saved_doc}}/{{total_docs}} document saved.
        </span> 
        <br>
        <span class="label label-important" ng-show="failed_doc > 0">
         {{failed_doc}} error while saving document.
        </span>
       </span>          
       <span ng-switch-when="false">
        <i class="icon-info-sign"></i>
         There are error of uploading file.
       </span>          
      </span>
    </div>

    <div class="row-fluid" ng-show="success_list.length>0">
     <p class="lead">Success List</p>  {{success_list.length}}
     <table class="table table-condensed">
      <tr ng-repeat="doc in success_list">
       <td ng-repeat="content in doc.json.cols">
         {{content.value}}
       </td>
      </tr>
     </ol>
    </div>

  </div>
</div>

<iframe id="upload_target" 
    name="upload_target" 
    style="width:0;height:0;border:0px solid #fff;">
</iframe>
